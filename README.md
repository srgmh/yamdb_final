![yamdb_workflow](https://github.com/srgmh/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

### Проект развёрнут на удалённом сервере:
http://84.201.167.175/

http://84.201.167.175/redoc/ - документация по API


# API для сервиса API_YAMDB

## Описание:
Данный проект реализует `REST API` и представляет собой сервис по хранению сведений о различных произведениях искусства, а именно - их описание и отзывы к ним. Хранение самих произведений в рамках этого проекта не предусмотрено.

### Список возможностей проекта:

- Регистрация пользователей
- Работа со списками произведений
- Работа со списками категорий
- Работа со списками обзоров
- Работа со списками комментариев к обзорам
- Работа со списками пользователей


### Стек: 
- Python 3.7
- Django
- Django REST Framework
- Simple-JWT
- PostgreSQL
- Docker
- nginx
- gunicorn

## Запуск проекта:

Склонировать репозиторий на компьютер и перейти в папку с проектом
```
git clone https://github.com/srgmh/infra_sp2.git
cd infra_sp2
```

Перейти в папку `infra_sp2/infra` и создать в ней файл `.env` с переменными окружения, необходимыми для работы приложения:
```
cd infra
```
Пример содержимого файла `.env`:
```
DB_ENGINE=django.db.backends.postgresql
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432
```
Запустить docker-compose:
```
docker-compose up
```
Будут созданы и запущены в фоновом режиме необходимые для работы приложения контейнеры (`db`, `web`, `nginx`).

Внутри контейнера ``web`` выполнить миграции:
```
docker-compose exec web python manage.py migrate
```
Создать суперпользователя:
```
docker-compose exec web python manage.py createsuperuser
```
Собрать статику:
```
docker-compose exec web python manage.py collectstatic --no-input
```
Если все сделано правильно, проект будет доступен по адресу: http://localhost/

Админка доступна по адресу: http://localhost/admin/

## Заполнение базы данных:
Загрузить готовую тестовую базу данных в развернутом проекте:
```
docker-compose exec web python manage.py loaddata fixtures.json 
```

## Документация в формате `Redoc`:
Для ознакомления с полной документацией по работе и возможностям проекта в развернутом проекте перейти на страницу: http://localhost/redoc/

## Примеры работы с API:

#### Пользовательские роли:
- Аноним — может просматривать описания произведений, читать отзывы и комментарии.
- Аутентифицированный пользователь (`user`) — может, как и Аноним, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
- Модератор (`moderator`) — те же права, что и у Аутентифицированного пользователя плюс право удалять любые отзывы и комментарии.
- Администратор (`admin`) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
- Суперюзер Django — обладает правами администратора (`admin`)

#### Примеры запросов:
```
Права доступа: Аноним
GET /api/v1/categories/ - Получение списка всех категорий
GET /api/v1/genres/ - Получение списка всех жанров
GET /api/v1/titles/ - Получение списка всех произведений
GET /api/v1/titles/{title_id}/reviews/ - Получение списка всех отзывов к произведению
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/ - Получение списка всех комментариев к отзыву
Права доступа: Администратор
GET /api/v1/users/ - Получение списка всех пользователей
```
